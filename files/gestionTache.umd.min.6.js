(("undefined"!==typeof self?self:this)["webpackJsonpgestionTache"]=("undefined"!==typeof self?self:this)["webpackJsonpgestionTache"]||[]).push([[6],{1267:function(t,e,n){},5724:function(t,e,n){"use strict";n("1267")},"618c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-block card-render-entity"},[n("CCard",[n("CCardHeader",{staticClass:"shadow-sm",class:["card-progress  card-color card-border card-border--"+t.dataLoad.type,t.background]},[n("CLink",{staticClass:"text-dark text-decoration-none link-card",attrs:{to:"/projets/"+t.dataLoad.idcontents}},[t._v(t._s(t.dataLoad.titre)+" ")]),n("div",{staticClass:"px-2 date-created"},[n("small",[t._v(t._s(t.createdAt))])]),t.progress.val&&t.progress.max?n("CProgress",{staticClass:"progress-xs card-prog",staticStyle:{height:"10px"},attrs:{animated:"1"!==t.dataLoad.status&&"3"!==t.dataLoad.status,showPercentage:"",striped:"1"!==t.dataLoad.status&&"3"!==t.dataLoad.status,max:t.progress.max,value:t.progress.val,color:t.color(t.progress.val,t.progress.max)}}):t._e(),n("div",{staticClass:"card-header-actions"},[n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Afficher/Cacher la description",expression:"'Afficher/Cacher la description'"}],staticClass:"btn-close m-2",attrs:{href:"#"},on:{click:function(e){t.descToggle=!t.descToggle}}},[n("CIcon",{attrs:{name:"cil-chevron-circle-"+(t.descToggle?"down":"up")+"-alt"}})],1),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Edité le contenu",expression:"'Edité le contenu'"}],staticClass:"btn-close m-2",attrs:{href:"#"},on:{click:t.modalEditOn}},[n("CIcon",{attrs:{name:"cil-pencil"}})],1),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Modifier le parent",expression:"'Modifier le parent'"}],staticClass:"btn-close m-2",attrs:{href:"#"},on:{click:t.changeParent}},[n("CIcon",{attrs:{name:"cil-cursor-move"}})],1),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Créer un sous contenu",expression:"'Créer un sous contenu'"}],staticClass:"btn-close m-1",attrs:{href:"#"},on:{click:t.HideTypeProject}},[n("CIcon",{attrs:{name:"cil-plus"}})],1),n("CLink",{staticClass:"m-2 btn-setting",attrs:{href:"#"},on:{click:t.modalRessourceOn}},[n("CIcon",{attrs:{name:"cil-settings"}})],1),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Afficher/Cacher les sous projects",expression:"'Afficher/Cacher les sous projects'"}],staticClass:"m-1 btn-minimize",on:{click:t.Collapsed}},[n("CIcon",{attrs:{name:"cil-chevron-"+(t.dataLoad.open?"bottom":"top")}})],1),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Supprimer ce contenu",expression:"'Supprimer ce contenu'"}],staticClass:"m-2 btn-close text-danger",attrs:{href:"#"},on:{click:t.DeleteModalOn}},[n("CIcon",{attrs:{color:"danger",name:"cil-x-circle"}})],1)],1)],1),n("CCollapse",{attrs:{show:t.dataLoad.open,duration:400}},[n("CCardBody",[n("CCollapse",{attrs:{show:t.descToggle,duration:400}},[n("div",{domProps:{innerHTML:t._s(t.textDisplay)}})]),t._t("default")],2)],1)],1),n("CModal",{attrs:{title:"Confirmer la suppression",color:"danger",show:t.deleteModal},on:{"update:show":function(e){t.deleteModal=e}}},[t._v(" êtes vous sûre de vouloir supprimer ce contenu? "),n("br"),n("small",{staticClass:"mt-2 text-center"},[t._v("Cette action est irréversible.")]),n("template",{slot:"footer"},[n("div",{staticClass:"d-flex justify-content-end mr-3"},[n("CButton",{staticClass:"mx-1",attrs:{color:"light"},on:{click:function(e){t.deleteModal=!1}}},[t._v("Cancel")]),n("CButton",{staticClass:"mx-1",attrs:{color:"danger",desabled:""},on:{click:t.DeleteContent}},[t._v("Supprimer")])],1)])],2),n("CModal",{attrs:{title:"Modification de la hiérarchie",color:"dark",show:t.hierarchiModal},on:{"update:show":function(e){t.hierarchiModal=e}}},[n("CRow",[n("CCol",{staticClass:"mr-0 pr-0",attrs:{col:"8",sm:"5"}},[n("CInput",{attrs:{label:"Ordre:",type:"number",horizontal:""},model:{value:t.newIdParrent.ordre,callback:function(e){t.$set(t.newIdParrent,"ordre",e)},expression:"newIdParrent.ordre"}})],1),n("CCol",{attrs:{md:"10"}},[n("SSearch",{on:{"parent-selected":t.parentSelected}}),n("small",[t._v("Choisir le nouveau parent")]),t._v(" "),n("br"),n("small",[t._v("Parent Actuel: "),n("strong",[t._v(t._s(t.dataLoad.idcontentsparent))])])],1)],1),n("template",{slot:"footer"},[n("div",{staticClass:"d-flex justify-content-end mr-3"},[n("CButton",{staticClass:"mx-1",attrs:{color:"light"},on:{click:function(e){t.hierarchiModal=!1}}},[t._v("Cancel")]),n("CButton",{staticClass:"mx-1",attrs:{color:"dark",desabled:""},on:{click:t.ChangeHierarchie}},[t._v("Enregistrer "),t.spinner?n("CSpinner",{staticStyle:{width:"1rem",height:"1rem"},attrs:{size:"sm",tag:"small",color:"primary"}}):t._e()],1)],1)])],2)],1)},a=[],r=n("c71b"),i=n("d111"),s=n("b8a6"),c=n("1487"),l=n.n(c),d=n("c1df"),u=n.n(d),p={name:"CardComponent",props:{dataLoad:{type:Object,required:!0,default:function(){return{}}},isCollapsed:{type:Object,default:function(){return{status:!1}}}},components:{SSearch:r["a"]},data:function(){return{btnStateEdit:{state:!1},modalEdit:!1,deleteModal:!1,hierarchiModal:!1,ressourceToAdd:"",chooseType:"text",descToggle:!0,currentTime:"",show:!0,max:"",spinner:!1,selected:"projet",addingModal:!1,modalRessource:!1,newIdParrent:{id:"",ordre:""},editorData:"<p>me al rasp sale</p>",editorConfig:{extraPlugins:"codesnippet",codeSnippet_theme:"monokai_sublime"},options:[{value:"projet",label:"Projet"},{value:"tache",label:"Tâche"},{value:"memos",label:"Mémos"}]}},mounted:function(){this.timing()},computed:{background:function(){var t="card-back",e=this.dataLoad.status;return t+"--"+e},progress:function(){var t={},e=u.a.unix(this.dataLoad.date_fin_proposer),n=u.a.unix(this.dataLoad.date_depart_proposer),o=u.a.unix(this.currentTime);this.dataLoad.date_fin_reel>0&&(o=u.a.unix(this.dataLoad.date_fin_reel));var a=o.diff(n,"minutes"),r=e.diff(n,"minutes");return t.max=r,t.val=a,t},textDisplay:function(){var t=document.createElement("div");return t.innerHTML=this.dataLoad.text?this.dataLoad.text:"",t.querySelectorAll("pre code").forEach((function(t){l.a.highlightBlock(t)})),t.outerHTML},createdAt:function(){return u()(this.dataLoad.created_at,"YYYY-MM-DD HH:mm").format("DD/MM/YYYY HH:mm")}},methods:{timing:function(){var t=this;2==this.dataLoad.status?(this.currentTime=u()().unix(),setInterval((function(){t.currentTime=u()().unix()}),5e3)):this.currentTime=u()().unix()},color:function(t,e){var n,o=0;return e>0&&t>0&&(o=100*t/e),n=o<=25?"success":o>25&&o<=50?"info":o>50&&o<=85?"secondary":o>85&&o<=100?"warning":"danger",n},parentSelected:function(t){this.newIdParrent.id=t.idcontents},ChangeHierarchie:function(){var t=this;this.spinner=!0,i["a"].formatHierarchie(this.dataLoad,this.newIdParrent).then((function(e){s["a"].post("/gestion-project/save-update",e).then((function(e){e.status&&(console.log("data after edit :",e),t.$emit("edition-ok",e)),t.spinner=!1,t.hierarchiModal=!1})).catch((function(t){console.log("error",t)}))}))},changeParent:function(){console.log("changeparent",this.dataLoad),this.$emit("change-parent",this.dataLoad),this.newIdParrent.ordre=this.dataLoad.ordre,this.hierarchiModal=!0},DeleteModalOn:function(){this.deleteModal=!0},DeleteContent:function(){var t=this;i["a"].formatDeleteData(this.dataLoad,"delete").then((function(e){console.log(" deleteProject : ",e),s["a"].post("/gestion-project/save-update",e).then((function(e){e.status&&(console.log("data after delete :",e),t.$emit("suppression-ok")),t.isLoading=!1})).catch((function(t){console.log("error",t)}))}))},Collapsed:function(){this.dataLoad.open?this.dataLoad.open=!1:this.dataLoad.open=!0},HideTypeProject:function(){this.$emit("Hide-type-project",this.dataLoad)},modalEditOn:function(){this.$emit("modal-edit-on",this.dataLoad)},modalRessourceOn:function(){this.$emit("modal-ressource-on")},modalEditOnText:function(t){console.log("Test edit : ",t.titre),this.$emit("ev-modal-edit-on",t)}}},f=p,h=(n("6b1d"),n("2877")),m=Object(h["a"])(f,o,a,!1,null,null,null),v=m.exports,g=n("f9cf");function C(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=b(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw r}}}}function b(t,e){if(t){if("string"===typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var _,x,j={name:"CardsJSX",props:{dataLoad:{type:Array,required:!0}},data:function(){return{btnStateEdit:{state:!1},modalEdit:!1,ressourceToAdd:"",chooseType:"text",descToggle:!1,show:!0,selected:"projet",addingModal:!1,modalRessource:!1,editorData:"<p>me al rasp sale</p>",editorConfig:{extraPlugins:"codesnippet",codeSnippet_theme:"monokai_sublime"},options:[{value:"projet",label:"Projet"},{value:"tache",label:"Tâche"},{value:"memos",label:"Mémos"}]}},render:function(t){var e=this,n=t,o=function t(o){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];return o.forEach((function(o){var i=[];if(o.open=a,Array.isArray(o.cards)){var s,c=C(e.options);try{var l=function(){var e=s.value;d=o.cards.filter((function(t){return t.type==e.value})),u=d.filter((function(t){return"0"==t.status})),p=d.filter((function(t){return"1"==t.status})),f=d.filter((function(t){return"2"==t.status})),h=d.filter((function(t){return"3"==t.status})),m=u.concat(f).concat(p).concat(h),g=t(m,!1),b=n("cBadge",{class:["badge-type-ressource","badge--"+e.value],style:{padding:"4px 7px","max-width":"100px"},attrs:{tag:"div"}},[n("strong",{style:{"font-weigth":"bold",color:"#fff67a ","margin-right":"2px","font-size":"1.2em"}},d.length),"   "+e.label]),d.length&&(i.push(b),i.push(g))};for(c.s();!(s=c.n()).done;){var d,u,p,f,h,m,g,b;l()}}catch(y){c.e(y)}finally{c.f()}}r.push(n(v,{props:{dataLoad:o},on:{"modal-edit-on":function(t){e.$emit("modal-edit-on",t)},"Hide-type-project":function(t){e.$emit("Hide-type-project",t)},"suppression-ok":function(){e.$emit("suppression-ok")},"change-parent":function(t){e.$emit("change-parent",t)},"edition-ok":function(){e.$emit("edition-ok")}}},i))})),r};return n("div",o(this.dataLoad,!0))},mounted:function(){this.loadOptions()},methods:{loadOptions:function(){var t=this;g["a"].loadType().then((function(e){t.options=e}))}}},L=j,w=Object(h["a"])(L,_,x,!1,null,null,null);e["default"]=w.exports},"6b1d":function(t,e,n){"use strict";n("b8d3")},b8d3:function(t,e,n){},c71b:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.styled?"searchForm":""},[n("multiselect",{attrs:{options:t.project,placeholder:"Tapez une recherche","hide-selected":!0,"max-height":600,"option-height":20,"show-labels":!1,searchable:!0,loading:t.isLoading,"track-by":"titre","internal-search":!0,showPointer:!0,label:"titre"},on:{"search-change":t.TypingSearch},scopedSlots:t._u([{key:"singleLabel",fn:function(e){return[n("span",{staticClass:"option__desc d-inline-flex flex-column"},[n("span",{staticClass:"option__title"},[t._v(t._s(e.option.titre))])])]}},{key:"option",fn:function(e){return[t.styled?n("div",{staticClass:"option__desc d-inline-flex flex-column align-items-start"},[n("span",{staticClass:"option__title mb-2"},[n("CIcon",{staticClass:"mr-1 text-info",attrs:{name:"cilFolder"}}),t._v(" "+t._s(e.option.titre)+" ")],1),n("div",{staticClass:"d-flex aling-items-center"},[n("span",{staticClass:"text-info bg-light p-1 mt-2 h6"},[t._v(t._s(e.option.type))]),n("router-link",{attrs:{to:"/projets/"+e.option.idcontents}},[n("CButton",{staticClass:"ml-4",attrs:{variant:"ghost",color:"warning",size:"sm"}},[n("CIcon",{attrs:{name:"cilPencil"}})],1)],1)],1)]):t._e(),t.styled?t._e():n("div",{staticClass:"option__desc d-inline-flex flex-column align-items-start",on:{click:function(n){return t.ParentSelected(e)}}},[n("span",{staticClass:"option__title mb-2"},[n("CIcon",{staticClass:"mr-1 text-dark",attrs:{name:"cilFolder"}}),t._v(" "+t._s(e.option.titre)+" "),n("small",{staticClass:"text-dark p-1 mt-2 ml-2 text-type"},[t._v(t._s(e.option.type))])],1)])]}}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1)},a=[],r=n("8e5f"),i=n.n(r),s=n("8bbf"),c=n.n(s),l=n("b8a6");c.a.component("multiselect",i.a);var d={props:{styled:{type:Boolean,default:!1}},components:{Multiselect:i.a},data:function(){return{value:"",searchValue:"",options:["list","of","options"],project:[],isLoading:!1,timer:null}},mounted:function(){},watch:{},computed:{pOptions:function(){var t=[];if(this.project.length)for(var e in this.project)t.push(this.project[e].titre);return t}},methods:{ParentSelected:function(t){console.log("dataSelected :",t.option),this.$emit("parent-selected",t.option)},TypingSearch:function(t){if(t.length>=2){this.isLoading=!0,this.value=t;var e=this;clearTimeout(e.timer),e.timer=setTimeout((function(){e.LoadProjectData()}),1500)}},LoadProjectData:function(){var t=this;this.isLoading=!0,l["a"].post("/gestion-project/search?key="+this.value,{level:0}).then((function(e){e.status&&e&&(t.project=e.data,console.log("Project search load",e)),t.isLoading=!1})).catch((function(t){console.log("error",t)}))}}},u=d,p=(n("60bc"),n("5724"),n("2877")),f=Object(p["a"])(u,o,a,!1,null,null,null);e["a"]=f.exports},f0ae:function(t,e,n){"use strict";var o=n("b8a6");e["a"]={selectDatas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{column:"c.type",operator:"=",value:"project"}];return new Promise((function(e){var n="";if(t.length)for(var a in t)n+=t[a].column+" "+t[a].operator+" '"+t[a].value+"' ";n+=" ORDER BY  c.`idcontents` DESC",n+=" limit 0,50 ",o["a"].post("/gestion-project/select/selectdatas",n).then((function(t){t.status?e(t.data):e([])}))}))},selectTypes:function(){return new Promise((function(t){o["a"].get("/gestion-project/select/project-type").then((function(e){e.status?t(e.data):t([])}))}))},selectProject:function(t){return new Promise((function(e){var n="";if(t.length)for(var a in t)n+=t[a].column+" "+t[a].operator+" '"+t[a].value+"' ";o["a"].post("/gestion-project/select/select-project",n).then((function(t){t.status?e(t.data):e([])}))}))},selectFatureList:function(t){var e=this;return new Promise((function(n){var a="";if(a+=" select * ",a+=" from ",a+=e.formatStringTable("gestion_project_invoice_list"),t.length)for(var r in a+=" WHERE ",t)a+=t[r].column+" "+t[r].operator+" '"+t[r].value+"' ";o["a"].post("/gestion-project/select",a).then((function(t){t.status?n(t.data):n([])}))}))},selectInvoice:function(t){var e=this;return new Promise((function(n){var a="";if(a+=" select * ",a+=" from ",a+=e.formatStringTable("gestion_project_invoice"),t.length)for(var r in a+=" WHERE ",t)a+=t[r].column+" "+t[r].operator+" '"+t[r].value+"' ";o["a"].post("/gestion-project/select",a).then((function(t){t.status?n(t.data):n([])}))}))},selectClients:function(t){var e=this;return new Promise((function(n){var a="";if(a+=" select * ",a+=" from ",a+=e.formatStringTable("gestion_project_client"),t.length)for(var r in a+=" WHERE ",t)a+=t[r].column+" "+t[r].operator+" '"+t[r].value+"' ";a+=" limit 0,50 ",o["a"].post("/gestion-project/select",a).then((function(t){t.status?n(t.data):n([])}))}))},selectSte:function(t){var e=this;return new Promise((function(n){var a="";if(a+=" select * ",a+=" from ",a+=e.formatStringTable("gestion_project_societe"),t.length)for(var r in a+=" WHERE ",t)a+=t[r].column+" "+t[r].operator+" '"+t[r].value+"' ";a+=" limit 0,50 ",o["a"].post("/gestion-project/select",a).then((function(t){t.status?n(t.data):n([])}))}))},selectClient:function(t){var e=this;return new Promise((function(n){var a="";a+=" select * ",a+=" from ",a+=e.formatStringTable(t),a+=" limit 0,50 ",o["a"].post("/gestion-project/select",a).then((function(t){t.status?n(t.data):n([])}))}))},selectAll:function(){return new Promise((function(t){var e="";e+=" c.idcontents is not NULL order by c.update_at DESC limit 0,30 ",o["a"].post("/gestion-project/select/select-project",e).then((function(e){e.status?t(e.data):t([])}))}))},SelectTacheEnours:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{column:"t.status",operator:"=",value:2}];return new Promise((function(e){var n="";if(t.length)for(var a in t)n+=t[a].column+" "+t[a].operator+" '"+t[a].value+"' ";n+=" ORDER BY  c.`idcontents` DESC ",n+=" limit 0,20 ",o["a"].post("/gestion-project/select/select-tache-enours",n).then((function(t){t.status?e(t.data):e([])}))}))},formatStringTable:function(t){return"{"+t+"}"}}},f9cf:function(t,e,n){"use strict";var o=n("f0ae"),a={opts:[],instance:!1,loadType:function(){var t=this;return new Promise((function(e){t.instance?t.instance.then((function(){e(t.opts)})):t.opts.length||(t.instance=o["a"].selectTypes(),t.instance.then((function(n){var o=[];for(var a in n)o.push({value:n[a].name,label:n[a].label,description:n[a].description});t.opts=o,e(t.opts)})))}))}};e["a"]=a}}]);
//# sourceMappingURL=gestionTache.umd.min.6.js.map