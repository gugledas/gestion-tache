(("undefined"!==typeof self?self:this)["webpackJsonpgestionTache"]=("undefined"!==typeof self?self:this)["webpackJsonpgestionTache"]||[]).push([[4],{"0b4b":function(t,e,o){},1267:function(t,e,o){},5724:function(t,e,o){"use strict";o("1267")},"60bc":function(t,e,o){"use strict";o("0b4b")},"618c":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"card-block card-render-entity"},[o("CCard",[o("CCardHeader",{staticClass:"shadow-sm",class:["card-progress  card-color card-border card-border--"+t.dataLoad.type,t.background]},[o("CLink",{staticClass:"text-dark text-decoration-none link-card",attrs:{to:"/projets/"+t.dataLoad.idcontents}},[t._v(t._s(t.dataLoad.titre)+" "),"1"==t.dataLoad.privaty?o("CBadge",{attrs:{color:"danger",position:"top-start",shape:"pill"}},[t._v(" Privé ")]):t._e()],1),o("div",{staticClass:"px-2 date-created"},[o("small",[t._v(t._s(t.createdAt))])]),t.progress.val&&t.progress.max?o("CProgress",{staticClass:"progress-xs card-prog",staticStyle:{height:"10px"},attrs:{animated:"1"!==t.dataLoad.status&&"3"!==t.dataLoad.status,showPercentage:"",striped:"1"!==t.dataLoad.status&&"3"!==t.dataLoad.status,max:t.progress.max,value:t.progress.val,color:t.color(t.progress.val,t.progress.max)}}):t._e(),o("div",{staticClass:"card-header-actions"},[o("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Afficher/Cacher la description",expression:"'Afficher/Cacher la description'"}],staticClass:"btn-close m-2",attrs:{href:"#"},on:{click:function(e){t.descToggle=!t.descToggle}}},[o("CIcon",{attrs:{name:"cil-chevron-circle-"+(t.descToggle?"down":"up")+"-alt"}})],1),o("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Edité le contenu",expression:"'Edité le contenu'"}],staticClass:"btn-close m-2",attrs:{href:"#"},on:{click:t.modalEditOn}},[o("CIcon",{attrs:{name:"cil-pencil"}})],1),o("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Modifier le parent",expression:"'Modifier le parent'"}],staticClass:"btn-close m-2",attrs:{href:"#"},on:{click:t.changeParent}},[o("CIcon",{attrs:{name:"cil-cursor-move"}})],1),o("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Créer un sous contenu",expression:"'Créer un sous contenu'"}],staticClass:"btn-close m-1",attrs:{href:"#"},on:{click:t.HideTypeProject}},[o("CIcon",{attrs:{name:"cil-plus"}})],1),o("CLink",{staticClass:"m-2 btn-setting",attrs:{href:"#"},on:{click:t.modalRessourceOn}},[o("CIcon",{attrs:{name:"cil-settings"}})],1),o("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Afficher/Cacher les sous projects",expression:"'Afficher/Cacher les sous projects'"}],staticClass:"m-1 btn-minimize",on:{click:t.Collapsed}},[o("CIcon",{attrs:{name:"cil-chevron-"+(t.dataLoad.open?"bottom":"top")}})],1),o("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:"Supprimer ce contenu",expression:"'Supprimer ce contenu'"}],staticClass:"m-2 btn-close text-danger",attrs:{href:"#"},on:{click:t.DeleteModalOn}},[o("CIcon",{attrs:{color:"danger",name:"cil-x-circle"}})],1)],1)],1),o("CCollapse",{attrs:{show:t.dataLoad.open,duration:400}},[o("CCardBody",[o("CCollapse",{attrs:{show:t.descToggle,duration:400}},[o("div",{domProps:{innerHTML:t._s(t.textDisplay)}})]),t._t("default")],2)],1)],1),o("CModal",{attrs:{title:"Confirmer la suppression",color:"danger",show:t.deleteModal},on:{"update:show":function(e){t.deleteModal=e}}},[t._v(" êtes vous sûre de vouloir supprimer ce contenu? "),o("br"),o("small",{staticClass:"mt-2 text-center"},[t._v("Cette action est irréversible.")]),o("template",{slot:"footer"},[o("div",{staticClass:"d-flex justify-content-end mr-3"},[o("CButton",{staticClass:"mx-1",attrs:{color:"light"},on:{click:function(e){t.deleteModal=!1}}},[t._v("Cancel")]),o("CButton",{staticClass:"mx-1",attrs:{color:"danger",desabled:""},on:{click:t.DeleteContent}},[t._v("Supprimer")])],1)])],2),o("CModal",{attrs:{title:"Modification de la hiérarchie",color:"dark",show:t.hierarchiModal},on:{"update:show":function(e){t.hierarchiModal=e}}},[o("CRow",[o("CCol",{staticClass:"mr-0 pr-0",attrs:{col:"8",sm:"5"}},[o("CInput",{attrs:{label:"Ordre:",type:"number",horizontal:""},model:{value:t.newIdParrent.ordre,callback:function(e){t.$set(t.newIdParrent,"ordre",e)},expression:"newIdParrent.ordre"}})],1),o("CCol",{attrs:{md:"10"}},[o("SSearch",{on:{"parent-selected":t.parentSelected}}),o("small",[t._v("Choisir le nouveau parent")]),t._v(" "),o("br"),o("small",[t._v("Parent Actuel: "),o("strong",[t._v(t._s(t.dataLoad.idcontentsparent))])])],1)],1),o("template",{slot:"footer"},[o("div",{staticClass:"d-flex justify-content-end mr-3"},[o("CButton",{staticClass:"mx-1",attrs:{color:"light"},on:{click:function(e){t.hierarchiModal=!1}}},[t._v("Cancel")]),o("CButton",{staticClass:"mx-1",attrs:{color:"dark",desabled:""},on:{click:t.ChangeHierarchie}},[t._v("Enregistrer "),t.spinner?o("CSpinner",{staticStyle:{width:"1rem",height:"1rem"},attrs:{size:"sm",tag:"small",color:"primary"}}):t._e()],1)],1)])],2)],1)},n=[],r=o("c71b"),i=o("d111"),s=o("b8a6"),c=o("1487"),l=o.n(c),d=o("c1df"),u=o.n(d),p={name:"CardComponent",props:{dataLoad:{type:Object,required:!0,default:function(){return{}}},isCollapsed:{type:Object,default:function(){return{status:!1}}}},components:{SSearch:r["a"]},data:function(){return{btnStateEdit:{state:!1},modalEdit:!1,deleteModal:!1,hierarchiModal:!1,ressourceToAdd:"",chooseType:"text",descToggle:!0,currentTime:"",show:!0,max:"",spinner:!1,selected:"projet",addingModal:!1,modalRessource:!1,newIdParrent:{id:"",ordre:""},editorData:"<p>me al rasp sale</p>",editorConfig:{extraPlugins:"codesnippet",codeSnippet_theme:"monokai_sublime"},options:[{value:"projet",label:"Projet"},{value:"tache",label:"Tâche"},{value:"memos",label:"Mémos"}]}},mounted:function(){this.timing()},computed:{background:function(){var t="card-back",e=this.dataLoad.status;return t+"--"+e},progress:function(){var t={},e=u.a.unix(this.dataLoad.date_fin_proposer),o=u.a.unix(this.dataLoad.date_depart_proposer),a=u.a.unix(this.currentTime);this.dataLoad.date_fin_reel>0&&(a=u.a.unix(this.dataLoad.date_fin_reel));var n=a.diff(o,"minutes"),r=e.diff(o,"minutes");return t.max=r,t.val=n,t},textDisplay:function(){var t=document.createElement("div");return t.innerHTML=this.dataLoad.text?this.dataLoad.text:"",t.querySelectorAll("pre code").forEach((function(t){l.a.highlightBlock(t)})),t.outerHTML},createdAt:function(){return u()(this.dataLoad.created_at,"YYYY-MM-DD HH:mm").format("DD/MM/YYYY HH:mm")}},methods:{timing:function(){var t=this;2==this.dataLoad.status?(this.currentTime=u()().unix(),setInterval((function(){t.currentTime=u()().unix()}),5e3)):this.currentTime=u()().unix()},color:function(t,e){return s["a"].color(t,e)},parentSelected:function(t){this.newIdParrent.id=t.idcontents},ChangeHierarchie:function(){var t=this,e=this;this.spinner=!0,i["a"].formatHierarchie(this.dataLoad,this.newIdParrent).then((function(o){s["a"].post("/gestion-project/save-update",o,{headers:{Authorization:s["a"].auth}}).then((function(e){e.status&&(console.log("data after edit :",e),t.$emit("edition-ok",e)),t.spinner=!1,t.hierarchiModal=!1})).catch((function(t){e.$emit("edition-error",o),console.log("error",t)}))}))},changeParent:function(){console.log("changeparent",this.dataLoad),this.$emit("change-parent",this.dataLoad),this.newIdParrent.ordre=this.dataLoad.ordre,this.hierarchiModal=!0},DeleteModalOn:function(){this.deleteModal=!0},DeleteContent:function(){var t=this,e=this;i["a"].formatDeleteData(this.dataLoad,"delete").then((function(o){console.log(" deleteProject : ",o),s["a"].post("/gestion-project/save-update",o,{headers:{Authorization:s["a"].auth}}).then((function(e){e.status&&(console.log("data after delete :",e),t.$emit("suppression-ok")),t.isLoading=!1})).catch((function(t){e.$emit("suppression-error"),console.log("error",t)}))}))},Collapsed:function(){this.dataLoad.open?this.dataLoad.open=!1:this.dataLoad.open=!0},HideTypeProject:function(){this.$emit("Hide-type-project",this.dataLoad)},modalEditOn:function(){console.log("ediut : ",this.dataLoad),this.$emit("modal-edit-on",this.dataLoad)},modalRessourceOn:function(){this.$emit("modal-ressource-on")},modalEditOnText:function(t){console.log("Test edit : ",t.titre),this.$emit("ev-modal-edit-on",t)}}},h=p,f=(o("6b1d"),o("2877")),m=Object(f["a"])(h,a,n,!1,null,null,null),v=m.exports,g=o("f9cf");function C(t,e){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=b(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,s=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return i=t.done,t},e:function(t){s=!0,r=t},f:function(){try{i||null==o.return||o.return()}finally{if(s)throw r}}}}function b(t,e){if(t){if("string"===typeof t)return _(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,a=new Array(e);o<e;o++)a[o]=t[o];return a}var y,x,j={name:"CardsJSX",props:{dataLoad:{type:Array,required:!0}},data:function(){return{btnStateEdit:{state:!1},modalEdit:!1,ressourceToAdd:"",chooseType:"text",descToggle:!1,show:!0,selected:"projet",addingModal:!1,modalRessource:!1,editorData:"<p>me al rasp sale</p>",editorConfig:{extraPlugins:"codesnippet",codeSnippet_theme:"monokai_sublime"},options:[{value:"projet",label:"Projet"},{value:"tache",label:"Tâche"},{value:"memos",label:"Mémos"}]}},render:function(t){var e=this,o=t,a=function t(a){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];return a.forEach((function(a){var i=[];if(a.open=n,Array.isArray(a.cards)){var s,c=C(e.options);try{var l=function(){var e=s.value;d=a.cards.filter((function(t){return t.type==e.value})),u=d.filter((function(t){return"0"==t.status})),p=d.filter((function(t){return"1"==t.status})),h=d.filter((function(t){return"2"==t.status})),f=d.filter((function(t){return"3"==t.status})),m=u.concat(h).concat(p).concat(f),g=t(m,!1),b=o("cBadge",{class:["badge-type-ressource","badge--"+e.value],style:{padding:"4px 7px","max-width":"100px"},attrs:{tag:"div"}},[o("strong",{style:{"font-weigth":"bold",color:"#fff67a ","margin-right":"2px","font-size":"1.2em"}},d.length),"   "+e.label]),d.length&&(i.push(b),i.push(g))};for(c.s();!(s=c.n()).done;){var d,u,p,h,f,m,g,b;l()}}catch(_){c.e(_)}finally{c.f()}}r.push(o(v,{props:{dataLoad:a},on:{"modal-edit-on":function(t){e.$emit("modal-edit-on",t)},"Hide-type-project":function(t){e.$emit("Hide-type-project",t)},"suppression-ok":function(){e.$emit("suppression-ok")},"change-parent":function(t){e.$emit("change-parent",t)},"edition-ok":function(){e.$emit("edition-ok")},"edition-error":function(){e.$emit("edition-error")}}},i))})),r};return o("div",a(this.dataLoad,!0))},mounted:function(){this.loadOptions()},methods:{loadOptions:function(){var t=this;g["a"].loadType().then((function(e){t.options=e}))}}},L=j,k=Object(f["a"])(L,y,x,!1,null,null,null);e["default"]=k.exports},"6b1d":function(t,e,o){"use strict";o("b8d3")},b8d3:function(t,e,o){},c71b:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:t.styled?"searchForm":""},[o("multiselect",{attrs:{options:t.project,placeholder:"Tapez une recherche","hide-selected":!0,"max-height":700,"option-height":20,"show-labels":!1,searchable:!0,loading:t.isLoading,"track-by":"titre","internal-search":!1,showPointer:!0,label:"titre"},on:{"search-change":t.TypingSearch},scopedSlots:t._u([{key:"singleLabel",fn:function(e){var a=e.option;return[o("span",{staticClass:"option__desc d-inline-flex flex-column"},[o("span",{staticClass:"option__title d-none"},[t._v(t._s(a.titre))])])]}},{key:"option",fn:function(e){return[o("router-link",{attrs:{to:"/projets/"+e.option.idcontents}},[t.styled?o("div",{staticClass:"option__desc d-inline-flex flex-column align-items-start"},[o("span",{staticClass:"option__title  d-flex align-items-center"},[o("CBadge",{staticClass:"mr-2",attrs:{color:t.badgeColor(e.option.type),position:"top-start",size:"sm",shape:"pill"}},[t._v(" "+t._s(e.option.type)+" ")]),o("span",{staticClass:"titre-option"},[t._v(t._s(e.option.titre))]),o("CIcon",{staticClass:"ml-3 pb-0 ",class:"text-"+t.badgeColor(e.option.type),attrs:{name:"cilShare",size:"sm"}})],1),o("div",{staticClass:"d-flex align-items-center"})]):t._e()]),t.styled?t._e():o("div",{staticClass:"option__desc d-inline-flex flex-column align-items-start",on:{click:function(o){return t.ParentSelected(e)}}},[o("span",{staticClass:"option__title mb-2"},[o("CIcon",{staticClass:"mr-1 text-dark",attrs:{name:"cilFolder"}}),t._v(" "+t._s(e.option.titre)+" "),o("small",{staticClass:"text-dark p-1 mt-2 ml-2 text-type"},[t._v(t._s(e.option.type))])],1)])]}}]),model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[o("span",{staticClass:"p-3",attrs:{slot:"noResult"},slot:"noResult"},[t._v(" Ooops! Aucun élement trouvé... ")])])],1)},n=[],r=o("8e5f"),i=o.n(r),s=o("8bbf"),c=o.n(s),l=o("b8a6");c.a.component("multiselect",i.a);var d={props:{styled:{type:Boolean,default:!1}},components:{Multiselect:i.a},data:function(){return{value:"",searchValue:"",options:["list","of","options"],project:[],isLoading:!1,timer:null}},mounted:function(){},watch:{},computed:{pOptions:function(){var t=[];if(this.project.length)for(var e in this.project)t.push(this.project[e].titre);return t}},methods:{badgeColor:function(t){var e="";switch(t){case"project":e="dark";break;case"bug":e="danger";break;case"a_faire":e="dark";break;case"tache":e="success";break;case"sous-projet":e="secondary";break;default:e="light"}return e},ParentSelected:function(t){console.log("dataSelected :",t.option),this.$emit("parent-selected",t.option)},TypingSearch:function(t){if(t.length>=2){this.isLoading=!0,this.value=t;var e=this;clearTimeout(e.timer),e.timer=setTimeout((function(){e.LoadProjectData()}),1500)}},LoadProjectData:function(){var t=this;this.isLoading=!0,l["a"].post("/gestion-project/search?key="+this.value,{level:0},{headers:{Authorization:l["a"].auth}}).then((function(e){e.status&&e&&(t.project=e.data,console.log("Project search load",e)),t.isLoading=!1})).catch((function(t){console.log("error",t)}))}}},u=d,p=(o("60bc"),o("5724"),o("2877")),h=Object(p["a"])(u,a,n,!1,null,null,null);e["a"]=h.exports},f0ae:function(t,e,o){"use strict";var a=o("b8a6"),n=a["a"].auth;e["a"]={selectDatas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{column:"c.type",operator:"=",value:"project"}];return new Promise((function(e){var o="";if(t.length)for(var r in t)o+=t[r].column+" "+t[r].operator+" '"+t[r].value+"' ";o+=" ORDER BY  c.`idcontents` DESC",o+=" limit 0,50 ",a["a"].post("/gestion-project/select/selectdatas",o,{headers:{Authorization:n}}).then((function(t){t.status?e(t.data):e([])}))}))},selectTypes:function(){return new Promise((function(t){a["a"].get("/gestion-project/select/project-type",{headers:{Authorization:n}}).then((function(e){e.status?t(e.data):t([])}))}))},selectProject:function(t){return new Promise((function(e){var o="";if(t.length)for(var r in t)o+=t[r].column+" "+t[r].operator+" '"+t[r].value+"' ";a["a"].post("/gestion-project/select/select-project",o,{headers:{Authorization:n}}).then((function(t){t.status?e(t.data):e([])}))}))},selectFatureList:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_invoice_list"),t.length)for(var i in r+=" WHERE ",t)r+=t[i].column+" "+t[i].operator+" '"+t[i].value+"' ";a["a"].post("/gestion-project/select",r,{headers:{Authorization:n}}).then((function(t){t.status?o(t.data):o([])}))}))},selectInvoice:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_invoice"),t.length)for(var i in r+=" WHERE ",t)r+=t[i].column+" "+t[i].operator+" '"+t[i].value+"' ";a["a"].post("/gestion-project/select",r,{headers:{Authorization:n}}).then((function(t){t.status?o(t.data):o([])}))}))},selectClients:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_client"),t.length)for(var i in r+=" WHERE ",t)r+=t[i].column+" "+t[i].operator+" '"+t[i].value+"' ";r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r,{headers:{Authorization:n}}).then((function(t){t.status?o(t.data):o([])}))}))},selectSte:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_societe"),t.length)for(var i in r+=" WHERE ",t)r+=t[i].column+" "+t[i].operator+" '"+t[i].value+"' ";r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r,{headers:{Authorization:n}}).then((function(t){t.status?o(t.data):o([])}))}))},selectClient:function(t){var e=this;return new Promise((function(o){var r="";r+=" select * ",r+=" from ",r+=e.formatStringTable(t),r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r,{headers:{Authorization:n}}).then((function(t){t.status?o(t.data):o([])}))}))},selectAll:function(){return new Promise((function(t){var e="";e+=" c.idcontents is not NULL order by c.update_at DESC limit 0,30 ",a["a"].post("/gestion-project/select/select-project",e,{headers:{Authorization:n}}).then((function(e){e.status?t(e.data):t([])}))}))},SelectTacheEnours:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{column:"t.status",operator:"=",value:2}];return new Promise((function(e,o){var r="";if(t.length)for(var i in t)r+=t[i].column+" "+t[i].operator+" '"+t[i].value+"' ";r+=" ORDER BY  c.`idcontents` DESC ",r+=" limit 0,20 ",a["a"].post("/gestion-project/select/select-tache-enours",r,{headers:{Authorization:n}}).then((function(t){t.status?e(t.data):e([])})).catch((function(t){o(t)}))}))},SelectMesTaches:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{column:"t.uid",operator:"=",value:8}];return new Promise((function(o,r){var i="";if(e.length)for(var s in e)i+=e[s].column+" "+e[s].operator+" '"+e[s].value+"' ";i+=" ORDER BY  c.`idcontents` DESC ",i+=" limit 0,20 ",a["a"].post("/gestion-project/select/select-mes-taches/"+t,i,{headers:{Authorization:n}}).then((function(t){t.status?o(t.data):o([])})).catch((function(t){r(t)}))}))},formatStringTable:function(t){return"{"+t+"}"}}},f9cf:function(t,e,o){"use strict";var a=o("f0ae"),n={opts:[],instance:!1,loadType:function(){var t=this;return new Promise((function(e){t.instance?t.instance.then((function(){e(t.opts)})):t.opts.length||(t.instance=a["a"].selectTypes(),t.instance.then((function(o){var a=[];for(var n in o)a.push({value:o[n].name,label:o[n].label,description:o[n].description});t.opts=a,e(t.opts)})))}))}};e["a"]=n}}]);
//# sourceMappingURL=gestionTache.umd.min.4.js.map