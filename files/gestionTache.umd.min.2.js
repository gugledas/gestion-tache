(("undefined"!==typeof self?self:this)["webpackJsonpgestionTache"]=("undefined"!==typeof self?self:this)["webpackJsonpgestionTache"]||[]).push([[2],{"2a5d":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{"check-valid-form":t.checkForSave}},[o("div",[o("CRow",{staticClass:"form-group",attrs:{gutters:!1}},[o("pre",[t._v("duree: "+t._s(t.dureeProjet))]),o("br"),o("CCol",{attrs:{sm:"3"}},[o("p",[t._v("Choisir un type:")])]),o("CCol",{attrs:{sm:"9"}},[o("CInputRadioGroup",{attrs:{options:t.options,checked:t.postData.type,custom:"",inline:""},on:{"update:checked":function(e){return t.$set(t.postData,"type",e)}}}),t.postData.type.length<2?o("small",{staticClass:"text-danger"},[t._v(" ce champ est requis ")]):t._e()],1)],1)],1),o("hr"),o("div",{staticClass:"pl-sm-2 "},["memos"!==t.postData.type&&""===t.postData.date_fin_reel?o("CRow",{staticClass:"form-group",attrs:{gutters:!1}},[o("CCol",{attrs:{sm:"2"}},[o("p",[t._v("Statut:")])]),o("CCol",{attrs:{sm:"10"}},[o("CInputRadioGroup",{attrs:{options:t.statusOpt,checked:t.postData.status,custom:"",inline:""},on:{"update:checked":function(e){return t.$set(t.postData,"status",e)}}})],1),t.showInputRaison?o("CCol",{attrs:{sm:"8",md:"7"}},[o("CTextarea",{attrs:{label:"Raison:",type:"textarea",horizontal:"",placeholder:"writes something...",rows:"2",description:"Une description de la raison du changement de status"},model:{value:t.postData.raison,callback:function(e){t.$set(t.postData,"raison",e)},expression:"postData.raison"}})],1):t._e()],1):t._e(),"memos"!==t.postData.type?o("CRow",[o("CCol",{attrs:{col:"12",lg:"6"}},[o("CRow",{staticClass:" "},[o("CInput",{staticClass:"col-10 col-sm-7",attrs:{label:"Debut:",type:"date",readonly:t.postData.date_fin_reel>0,horizontal:""},model:{value:t.postData.date_depart_proposer,callback:function(e){t.$set(t.postData,"date_depart_proposer",e)},expression:"postData.date_depart_proposer"}}),o("CInput",{staticClass:"col-8 ml-sm-0 pl-sm-0 col-sm-5 ",attrs:{readonly:t.postData.date_fin_reel>0,type:"time",horizontal:""},model:{value:t.postData.heure_debut,callback:function(e){t.$set(t.postData,"heure_debut",e)},expression:"postData.heure_debut"}})],1)],1),o("CCol",{attrs:{col:"10",lg:"6"}},[o("CRow",{},[o("CInput",{staticClass:"col-10 col-sm-7",attrs:{label:"Fin:",readonly:t.postData.date_fin_reel>0,type:"date",horizontal:""},model:{value:t.postData.date_fin_proposer,callback:function(e){t.$set(t.postData,"date_fin_proposer",e)},expression:"postData.date_fin_proposer"}}),o("CInput",{staticClass:"col-8 ml-sm-0 pl-sm-0 col-sm-5 ",attrs:{readonly:t.postData.date_fin_reel>0,type:"time",horizontal:""},model:{value:t.postData.heure_fin,callback:function(e){t.$set(t.postData,"heure_fin",e)},expression:"postData.heure_fin"}})],1)],1)],1):t._e(),o("CRow",[o("CCol",{attrs:{sm:"7"}},[o("CInput",{attrs:{label:"Title:",placeholder:"Entrez un titre",wasValidated:t.wasValidated,validFeedback:"ok",invalidFeedback:"requis",isValid:t.inputValidation},model:{value:t.postData.titre,callback:function(e){t.$set(t.postData,"titre",e)},expression:"postData.titre"}})],1),"project"==t.postData.type?o("CCol",{attrs:{sm:"5"}},[o("CInput",{attrs:{label:"Nom du Client:",placeholder:"Select or add new Client"},model:{value:t.postData.clientName,callback:function(e){t.$set(t.postData,"clientName",e)},expression:"postData.clientName"}})],1):t._e()],1),o("CRow",[o("CCol",{attrs:{sm:"12"}},[o("label",[t._v("Description:")]),o("ckeditor",{attrs:{config:t.editorConfig},on:{namespaceloaded:t.onNamespaceLoaded},model:{value:t.postData.text,callback:function(e){t.$set(t.postData,"text",e)},expression:"postData.text"}})],1)],1),"project"==t.postData.type?o("CRow",[o("CCol",{attrs:{col:"8",lg:"4"}},[o("CInput",{attrs:{label:"Estimation du coût:",append:".00",description:"montant",prepend:"$"},model:{value:t.postData.price,callback:function(e){t.$set(t.postData,"price",e)},expression:"postData.price"}})],1)],1):t._e()],1)])},r=[],n=o("d111"),s=o("25ae"),i=o.n(s),c=o("1487"),l=o.n(c),p=o("b8a6"),u=o("c1df"),f=o.n(u),d=o("f0ae"),h={opts:[],instance:!1,loadType:function(){var t=this;return new Promise((function(e){t.instance?t.instance.then((function(){e(t.opts)})):t.opts.length||(t.instance=d["a"].selectTypes(),t.instance.then((function(o){var a=[];for(var r in o)a.push({value:o[r].name,label:o[r].label,description:o[r].description});t.opts=a,e(t.opts)})))}))}},m=h;function b(t,e){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_(t))||e&&t&&"number"===typeof t.length){o&&(t=o);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,i=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){i=!0,n=t},f:function(){try{s||null==o.return||o.return()}finally{if(i)throw n}}}}function _(t,e){if(t){if("string"===typeof t)return v(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,a=new Array(e);o<e;o++)a[o]=t[o];return a}function g(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function D(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?g(Object(o),!0).forEach((function(e){C(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function C(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var y={name:"PopUpContent",props:{formValues:{type:[Object],required:!0},btnState:{type:Object,default:function(){return{state:!1}}},level:{type:Number,default:0}},components:{ckeditor:i.a.component},data:function(){return{postData:{typeIsOk:!1,type:"project",status:"0",date_depart_proposer:"",date_fin_proposer:"",date_fin_reel:"",temps_pause:"",raison:"",heure_debut:"",heure_fin:"",clientName:"",titre:"",price:"",text:""},fHeure:"",dHeure:"",wasValidated:null,showInputRaison:!1,editorData:"",warningModal:!1,extraPlugins:"",preEditorConfig:{codeSnippet_theme:"monokai_sublime",stylesSet:[],contentsCss:" @import '"+p["a"].baseUrl+"/modules/custom/gestion_tache/files/gestionTache.css'; body{margin:1em !important; background: #FFF;}",on:{instanceReady:function(){this.dataProcessor.writer.setRules("p",{indent:!0,breakBeforeOpen:!0,breakAfterOpen:!1,breakBeforeClose:!0,breakAfterClose:!0}),this.dataProcessor.writer.setRules("img",{indent:!0,breakBeforeOpen:!0,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("h1",{indent:!0,breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("h2",{indent:!0,breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("h3",{indent:!0,breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("h4",{indent:!0,breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("h5",{indent:!0,breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("h6",{indent:!0,breakBeforeOpen:!1,breakAfterOpen:!1,breakBeforeClose:!1,breakAfterClose:!1}),this.dataProcessor.writer.setRules("div",{indent:!0,breakBeforeOpen:!0,breakAfterOpen:!0,breakBeforeClose:!0,breakAfterClose:!1})}}},options:[],statusOpt:[{value:"0",label:"New"},{value:"2",label:"Encours"},{value:"1",label:"Terminé"},{value:"3",label:"Annulé"}]}},mounted:function(){var t=this;m.loadType().then((function(e){t.options=e}))},watch:{formValues:{deep:!0,handler:function(t){n["a"].fomatVal(t,this.postData).then((function(){})),console.log("result :",this.postData,this.fHeure),console.log("debut heure : ",this.dHeure)}}},computed:{dureeProjet:function(){var t;return this.formValues.date_depart_proposer&&this.formValues.date_fin_proposer&&(t=this.formValues.date_fin_proposer-this.formValues.date_depart_proposer),t},tarara:function(){var t=this.postData.date_depart_proposer+" "+this.dHeure,e=f()(t,"YYYY-MM-DD HH:mm").unix(),o=f.a.unix(e).format("HH:mm"),a=[];return a.push(e),a.push(o),a},checkForSave:function(){return 1==this.wasValidated&&this.postData.type.length>2?(this.setBtnState(!0),!0):(this.setBtnState(!1),!1)},ser:function(){var t=document.createElement("div");return t.innerHTML=this.editorData,t.querySelectorAll("pre code").forEach((function(t){l.a.highlightBlock(t)})),t.outerHTML},editorConfig:function(){var t="codesnippet,print,format,font,colorbutton,justify,image,filebrowser,stylesheetparser";return window.location.host.includes("localhost--")?D({extraPlugins:t},this.preEditorConfig):D({extraPlugins:t+",quickuploader"},this.preEditorConfig)},optionsTache:function(){var t,e=[],o=b(this.options);try{for(o.s();!(t=o.n()).done;){var a=t.value;"project"==a.value||e.push(a)}}catch(r){o.e(r)}finally{o.f()}return e}},methods:{onNamespaceLoaded:function(t){f.a,t.plugins.addExternal("quickuploader",p["a"].baseUrl+"/libraries/quickuploader/plugin.js?v="+f()().unix()),t.config.allowedContent=!0,t.config.htmlEncodeOutput=!1,t.config.entities=!1,t.config.quickuploaderUploadUrl=p["a"].baseUrl,t.dtd.$removeEmpty.span=0,t.dtd.$removeEmpty.i=0,t.dtd.$removeEmpty.label=0},setBtnState:function(t){this.btnState.state=t},inputValidation:function(t){return t.length<=4?(this.wasValidated=!1,!1):(this.wasValidated=!0,!0)},EventShowInput:function(){},TimeNow:function(){var t=f()().format("YYYY-MM-DD"),e=f()().format("HH:mm");this.postData.date_depart_proposer=t,this.postData.heure_debut=e,this.postData.date_fin_proposer=t,this.postData.heure_fin=e},changeType:function(){this.options=this.optionsTache,this.postData.type="tache"},EditProject:function(){var t=this;n["a"].formatData(this.postData,this.dHeure,this.fHeure).then((function(e){p["a"].post("/gestion-project/save-update",e).then((function(e){e.status&&t.$emit("edition-ok",e),t.isLoading=!1})).catch((function(t){console.log("error",t)}))}))},FormatTime:function(t){var e=this.postData,o=f()(e.date_depart_proposer,"YYYY-MM-DD  HH:mm").unix(),a=f()(e.date_fin_proposer,"YYYY-MM-DD  HH:mm").unix(),r=[];r.push({idcontents:t,date_depart_proposer:o,date_fin_proposer:a})},FormatData:function(t){var e=this.postData,o=f()(e.date_depart_proposer,"YYYY-MM-DD  HH:mm").unix(),a=f()(e.date_fin_proposer,"YYYY-MM-DD  HH:mm").unix(),r=parseInt(this.postData.status,10),n=[];return n.push({table:"gestion_project_contents",fields:{text:e.text,titre:e.titre,type:e.type},childstable:{colum_id_name:"idcontents",tables:[{table:"gestion_project_times",fields:{date_depart_proposer:o,date_fin_proposer:a,status:r}},{table:"gestion_project_hierachie",fields:{idcontentsparent:t,ordre:0}}]}}),n},PostNewProject:function(t){var e=this;n["a"].formatAddData(this.postData,t,this.level).then((function(t){console.log("created",t),p["a"].post("/gestion-project/save-update",t).then((function(t){t.status&&(e.request=t.data[0],e.$emit("addnew-ok")),e.isLoading=!1})).catch((function(t){console.log("error",t)}))}))}}},k=y,w=o("2877"),j=Object(w["a"])(k,a,r,!1,null,"6c887bd0",null);e["default"]=j.exports},f0ae:function(t,e,o){"use strict";var a=o("b8a6");e["a"]={selectDatas:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{column:"c.type",operator:"=",value:"project"}];return new Promise((function(o){var r="";if(r+=" select ",r+=" c.idcontents, c.text, c.titre, c.created_at, ",r+=" c.update_at, c.type, h.idhierachie, h.idcontentsparent, ",r+=" h.ordre, h.level",r+=" from ",r+=t.formatStringTable("gestion_project_hierachie")+" as h ",r+=" INNER JOIN ",r+=t.formatStringTable("gestion_project_contents")+" as c ",r+=" ON h.idcontents = c.idcontents ",e.length)for(var n in r+=" WHERE ",e)r+=e[n].column+" "+e[n].operator+" '"+e[n].value+"' ";r+=" ORDER BY  c.`idcontents` DESC",r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectTypes:function(){var t=this;return new Promise((function(e){var o="";o+=" select * ",o+=" from ",o+=t.formatStringTable("gestion_project_type"),o+=" limit 0,50 ",a["a"].post("/gestion-project/select",o).then((function(t){t.status?e(t.data):e([])}))}))},selectProject:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_contents"),t.length)for(var n in r+=" WHERE ",t)r+=t[n].column+" "+t[n].operator+" '"+t[n].value+"' ";a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectFatureList:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_invoice_list"),t.length)for(var n in r+=" WHERE ",t)r+=t[n].column+" "+t[n].operator+" '"+t[n].value+"' ";a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectInvoice:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_invoice"),t.length)for(var n in r+=" WHERE ",t)r+=t[n].column+" "+t[n].operator+" '"+t[n].value+"' ";a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectClients:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_client"),t.length)for(var n in r+=" WHERE ",t)r+=t[n].column+" "+t[n].operator+" '"+t[n].value+"' ";r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectSte:function(t){var e=this;return new Promise((function(o){var r="";if(r+=" select * ",r+=" from ",r+=e.formatStringTable("gestion_project_societe"),t.length)for(var n in r+=" WHERE ",t)r+=t[n].column+" "+t[n].operator+" '"+t[n].value+"' ";r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectClient:function(t){var e=this;return new Promise((function(o){var r="";r+=" select * ",r+=" from ",r+=e.formatStringTable(t),r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},selectAll:function(){var t=this;return new Promise((function(e){var o="";o+=" select * ",o+=" from ",o+=t.formatStringTable("gestion_project_contents"),o+=" order by update_at DESC ",o+=" limit 0,50 ",a["a"].post("/gestion-project/select",o).then((function(t){t.status?e(t.data):e([])}))}))},SelectTacheEnours:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{column:"t.status",operator:"=",value:2}];return new Promise((function(o){var r="";if(r+=" select ",r+=" c.idcontents, c.text, c.titre, c.created_at, ",r+=" c.update_at, c.type, h.idhierachie, h.idcontentsparent, ",r+=" h.ordre, h.level, ",r+=" t.status",r+=" from ",r+=t.formatStringTable("gestion_project_hierachie")+" as h ",r+=" INNER JOIN ",r+=t.formatStringTable("gestion_project_contents")+" as c ",r+=" ON h.idcontents = c.idcontents ",r+=" INNER JOIN ",r+=t.formatStringTable("gestion_project_times")+" as t ",r+=" ON t.idcontents = c.idcontents ",e.length)for(var n in r+=" WHERE ",e)r+=e[n].column+" "+e[n].operator+" '"+e[n].value+"' ";r+=" ORDER BY  c.`idcontents` DESC",r+=" limit 0,50 ",a["a"].post("/gestion-project/select",r).then((function(t){t.status?o(t.data):o([])}))}))},formatStringTable:function(t){return"{"+t+"}"}}}}]);
//# sourceMappingURL=gestionTache.umd.min.2.js.map